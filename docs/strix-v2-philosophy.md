# Strix v2 设计哲学  
**—— 从"AI 驱动扫描器"到"人主导的智能安全分析系统"**

---

## 一、写在最前：为什么需要 Strix v2

Strix v1 的问题并不在于工程能力不足，而在于**设计假设本身错误**。

v1 隐含的核心假设包括：

- LLM 可以作为系统"大脑"
- Agent 可以自主决定流程
- Docker / Sandbox 可以兜住所有不确定性
- 扫描应当"一键跑完"

这些假设在 Demo 中成立，但在真实安全工程中**系统性失效**，最终表现为：

- thinking / processing 卡死
- 状态不可解释
- 错误被吞掉
- 用户无法接管

**Strix v2 的目标不是"修补 v1"，而是明确否定这些假设。**

---

## 二、Strix v2 的核心世界观

### 1️⃣ 人是系统的最终控制者（Human-in-the-loop）

Strix v2 的第一原则是：

> **任何一步，系统都不能在用户不知情的情况下推进。**

这意味着：

- 没有"自主 Agent"
- 没有隐藏状态机
- 没有不可中断的自动流程

系统必须能够回答三个问题：

1. 现在在做什么  
2. 为什么要这样做  
3. 如果我现在停下，会发生什么  

**如果不能回答，这就是一个 Bug。**

---

### 2️⃣ LLM 不是大脑，而是顾问（Advisor, not Controller）

在 Strix v2 中：

- LLM **不拥有执行权**
- LLM **不决定流程**
- LLM **不直接调用工具**

LLM 的职责被严格限定为：

- 分析已有证据
- 解释工具输出
- 提示潜在风险模式
- 降低人的认知成本

一句话总结：

> **LLM 只能"建议"，不能"行动"。**

这是 Strix v2 与 v1 最根本的分水岭。

---

### 3️⃣ 流程必须是确定性的（Deterministic Flow）

Strix v2 明确拒绝：

- 自主 reasoning loop
- LangGraph / Agent 状态机
- "直到 LLM 满意为止"的循环

取而代之的是：

- 明确的阶段划分
- 明确的进入条件
- 明确的终态（成功 / 失败）

> **任何没有终态的流程都是设计缺陷。**

---

## 三、为什么彻底移除 Docker / Sandbox

Docker 和 Sandbox 在 v1 中被赋予了错误的职责：

- 被当作"安全兜底"
- 被当作"失败隔离器"
- 被当作"系统边界"

但事实证明：

- 它们只隔离了错误，**没有消除错误**
- 它们制造了隐式依赖
- 它们让系统状态变得不可见

Strix v2 的选择是：

> **暴露真实世界，而不是模拟安全世界。**

因此：

- 工具直接在本地执行
- 错误直接暴露给用户
- 风险通过"可视化 + 人审"控制

这是工程现实主义，而不是退步。

---

## 四、新架构的设计原则

### Server + Engine + Plugin

Strix v2 的架构遵循三条铁律。

---

### 1️⃣ Server：状态可见

Server 负责：

- 当前阶段是什么
- 系统在等待什么输入
- 是否可以被中断

> **状态必须对人可读，而不是只存在于内存。**

---

### 2️⃣ Engine：流程裁决者

Engine 是唯一拥有流程推进权的组件：

- 决定下一步是否合法
- 决定是否进入终态
- 决定是否允许继续

> **Engine 是系统秩序的守门人。**

---

### 3️⃣ Plugin：工具即仪器

在 Strix v2 中：

- 插件是显式注册的
- 插件调用是显式触发的
- 插件输出直接面向人

工具不再是 Agent 的"内脏器官"，而是：

> **人可观察、可理解、可审计的仪器。**

---

## 五、Strix v2 明确反对的设计模式

以下模式在 v2 中被视为**反模式**：

- ❌ 自主 Agent Loop
- ❌ LLM 决定工具
- ❌ 自动重试掩盖错误
- ❌ Silent Failure
- ❌ "跑完就算"的扫描哲学
- ❌ 文档与代码行为不一致

**任何试图引入上述模式的改动，都应被视为架构回退。**

---

## 六、重新定义"让 LLM 发现漏洞"

在 Strix v2 中，这句话的真实含义是：

> **让 LLM 帮助人理解漏洞，而不是代替人做安全决策。**

LLM 可以：

- 总结证据
- 关联上下文
- 提示潜在攻击路径

但不能：

- 自主扫描
- 自主推进流程
- 自主宣告"完成"

> **安全的责任，必须始终在人。**

---

## 七、给未来维护者的一句话

如果你准备：

- 引入新的自动化
- 让系统"更聪明"
- 减少人的参与

请先回答一个问题：

> **当系统做错时，谁能第一时间看见并阻止它？**

如果答案不是"用户"，  
那么这项改动不属于 Strix v2。

---

## 结语

Strix v2 不是一个"更聪明的扫描器"，  
而是一个**更诚实的安全分析系统**。

它承认：

- 不确定性无法被消除
- 自动化无法替代判断
- LLM 不是魔法

但正因为如此，它才第一次**值得被信任**。
